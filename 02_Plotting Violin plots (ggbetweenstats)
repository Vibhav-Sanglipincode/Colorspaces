library(ggsci)
library(ggplot2)
library(tidyverse)
library(ggstatsplot)
library(patchwork)

# Load your data
df <- read_csv("C:/Users/vibha/Downloads/AMNH  - Owlets Analysis.csv")
df <- df %>%
  mutate(
    Subspecie = str_trim(str_to_title(Subspecie)),
    Region = str_trim(Region),
    mean_RGB = rowMeans(across(c(Red, Green, Blue)), na.rm = TRUE)
  )
df_Throat <- df %>%
  filter(Region == "Throat")

# L*
p_r <- ggbetweenstats(
  data = df_Throat,
  x = Subspecie,
  y = L,
  xlab = "Subspecies",
  title = "L* indicated lightness",
  type = "parametric",
  package = "ggsci",
  palette = "uniform_startrek"
)

# a*
p_g <- ggbetweenstats(
  data = df_Throat,
  x = Subspecie,
  y = a,
  xlab = "Subspecies",
  title = "a* is the red/green coordinate",
  type = "parametric",
  package = "ggsci",
  palette = "uniform_startrek"
)

# b*
p_b <- ggbetweenstats(
  data = df_Throat,
  x = Subspecie,
  y = b,
  xlab = "Subspecies",
  title = "b* is the yellow/blue coordinate",
  type = "parametric",
  package = "ggsci",
  palette = "uniform_startrek"
)

(p_r | p_g | p_b) +
  plot_annotation(title = "Jungle Owlet (Male and Female) - CIELAB color space analysis for - Throat region")

combined_plot <- combine_plots(
  list(p_r, p_g, p_b),
  plotgrid.args = list(nrow = 1),
  annotation.args = list(
    title = "Jungle Owlet (Male and Female) - CIELAB color space analysis for - Throat region",
    caption = "Source: AMNH Museum Collection"
  )
)
ggsave(
  filename = "figures/Owlets - Throat.png",  # Name of the output file
  plot = combined_plot,             # The plot object
  width = 15,                       # Width of the image in inches
  height = 10,                      # Height of the image in inches
  dpi = 600                         # Resolution in dots per inch (DPI)
)
